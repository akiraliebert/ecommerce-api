# üõí E-commerce Backend (FastAPI)

–£—á–µ–±–Ω–æ-–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π backend-–ø—Ä–æ–µ–∫—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å —É–ø–æ—Ä–æ–º –Ω–∞ **—á–∏—Å—Ç—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É**, **domain-driven design**, **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å**, **—Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** –∏ **—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –±–∏–∑–Ω–µ—Å-—Å—Ü–µ–Ω–∞—Ä–∏–∏**.

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–ª—Å—è –∫–∞–∫ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ —Å —Ü–µ–ª—å—é –ø–æ–∫–∞–∑–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –∑–Ω–∞–Ω–∏–µ FastAPI, –Ω–æ –∏ **–∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é backend-—Å–∏—Å—Ç–µ–º**.

---

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

- ### –ü–æ–∫–∞–∑–∞—Ç—å —É–º–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å backend, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø–∏—Å–∞—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

- ### –ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –∏ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏

- ### –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏–µ DDD, Clean Architecture, CQRS-light

- ### –ü—Ä–∞–∫—Ç–∏–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö

---

## üöÄ –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **Python 3.12**
- **FastAPI**
- **SQLAlchemy 2.0 (async)**
- **PostgreSQL**
- **Alembic**
- **JWT (access + refresh tokens)**
- **Pytest (unit / integration / e2e)**
- **Docker / Docker Compose**

> Redis –∏ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ –±—Ä–æ–∫–µ—Ä—ã —Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–µ —É—Å–ª–æ–∂–Ω—è–µ—Ç—Å—è –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

---

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º **Clean Architecture / Hexagonal Architecture**:
```text
app/
‚îú‚îÄ‚îÄ domain/ # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ 
‚îÇ   ‚îú‚îÄ‚îÄ entities
‚îÇ   ‚îú‚îÄ‚îÄ repositories
‚îÇ   ‚îî‚îÄ‚îÄ services
‚îÇ
‚îú‚îÄ‚îÄ application/ # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ dto/
‚îÇ   ‚îú‚îÄ‚îÄ use_cases/
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ
‚îú‚îÄ‚îÄ infrastructure/ # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ database/ # SQLAlchemy models, repo implementations
‚îÇ   ‚îú‚îÄ‚îÄ security/ # JWTService, PasswordHasher
‚îÇ   ‚îî‚îÄ‚îÄ web/ # FastAPI routers, schemas, dependencies
‚îÇ
‚îú‚îÄ‚îÄ config/ # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ
‚îî‚îÄ‚îÄ main.py
```

---

### üîπ Domain Layer
- #### –°—É—â–Ω–æ—Å—Ç–∏ (`Product`, `Cart`, `Order`, `InventoryReservation`, `User`)
- #### –ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç—ã –∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞
- #### –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- #### `UnitOfWork` –∫–∞–∫ –∫–æ–Ω—Ç—Ä–∞–∫—Ç

### ‚ùó Domain **–Ω–µ –∑–Ω–∞–µ—Ç**:
- #### –æ FastAPI
- #### –æ SQLAlchemy
- #### –æ JWT
- #### –æ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

---

### üîπ Application Layer
- Use-cases (CreateProduct, Checkout, PlaceOrder, PayOrder –∏ –¥—Ä.)
- DTO –¥–ª—è –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞
- –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ `UnitOfWork`

---

### üîπ Infrastructure Layer
- SQLAlchemy –º–æ–¥–µ–ª–∏
- –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- JWT —Å–µ—Ä–≤–∏—Å
- Password hashing
- –†–∞–±–æ—Ç–∞ —Å –ë–î

---

### üîπ Web Layer
- FastAPI routers
- Pydantic schemas
- Dependencies
- JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- HTTP-–æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

---

## üß© –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –õ–æ–≥–∏–Ω
- JWT access + refresh —Ç–æ–∫–µ–Ω—ã
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ refresh
- –ó–∞—â–∏—â—ë–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

---

### üì¶ –ü—Ä–æ–¥—É–∫—Ç—ã
- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ –ø–æ ID
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ / —É–¥–∞–ª–µ–Ω–∏–µ
- –ö–æ–Ω—Ç—Ä–æ–ª—å –æ—Å—Ç–∞—Ç–∫–æ–≤

---

### üõí –ö–æ—Ä–∑–∏–Ω–∞
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
- –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
- –û—á–∏—Å—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã

–ö–æ—Ä–∑–∏–Ω–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–∞–∫ **aggregate root** —Å –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –¥–æ–º–µ–Ω–∞.

---

### üì¶ Inventory
- –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞
- –û—Ç–º–µ–Ω–∞ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è
- –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞

---

### üìÑ –ó–∞–∫–∞–∑—ã
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –ø–æ ID
- –û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ (mock payment)
- –û—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–∞

---

## üí≥ –û–ø–ª–∞—Ç–∞

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω **Payment Service (mock)**:
- –û—Ç–¥–µ–ª—ë–Ω –æ—Ç –¥–æ–º–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏
- –õ–µ–≥–∫–æ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ Stripe / YooKassa / CloudPayments
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ application-service

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –ø–æ–∫—Ä—ã—Ç —Ç–µ—Å—Ç–∞–º–∏ **–Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö**:

### ‚úîÔ∏è Unit tests
- Domain entities
- Use-cases
- Services

### ‚úîÔ∏è Integration tests
- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- UnitOfWork
- Use-cases —Å —Ä–µ–∞–ª—å–Ω–æ–π –ë–î

### ‚úîÔ∏è End-to-End (E2E)
- –ü–æ–ª–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —á–µ—Ä–µ–∑ HTTP
- Auth ‚Üí Cart ‚Üí Order ‚Üí Payment
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –æ—à–∏–±–æ–∫

–¢–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è **–≤ Docker**, –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ.

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### üîπ 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
```bash
git clone https://github.com/akiraliebert/ecommerce-api.git
cd ecommerce-api
```
### üîπ 2. –°–æ–∑–¥–∞—Ç—å .env

#### –°–º–æ—Ç—Ä–∏—Ç–µ –≤ –ø—Ä–∏–º–µ—Ä–µ .env.example

### üîπ 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
```bash
docker compose up --build
```
### üîπ 4. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
```bash
docker compose run app alembic upgrade head
```

---

## üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
docker compose -f docker-compose.test.yml up --build --abort-on-container-exit
```
### –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
```bash
docker compose -f docker-compose.test.yml down -v
```

> #### (–ò—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –±–¥)

---

## üìå –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- ### –†–µ–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç—ë–∂–Ω—ã–º –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º

- ### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ (Celery / RQ)

- ### Event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- ### –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

- ### CI/CD

---
